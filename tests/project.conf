targets=Dummy.h,appclient,appmessage,appserver,includes,lookup,tests.log,transport
cppflags_force=-I ../include -isystem .
cflags_force=`pkg-config --cflags libSystem`
cflags=-W -Wall -g -O2 -pedantic -fPIE -D_FORTIFY_SOURCE=2 -fstack-protector-all
ldflags_force=`pkg-config --libs libSystem` -lApp
ldflags=-L../src -Wl,-rpath,../src -Wl,-pie -Wl,-z,relro -Wl,-z,now -rdynamic
dist=System/App.h,Makefile,Test.interface,tests.sh

[Dummy.h]
type=script
script=../tools/appbroker.sh -O APPBROKER=../tools/AppBroker
depends=../data/Dummy.interface,../tools/appbroker.sh

[appclient]
type=binary
sources=appclient.c
ldflags=../src/libApp.a

[appclient.c]
depends=../src/libApp.a

[appmessage]
type=binary
sources=appmessage.c
ldflags=../src/libApp.a

[appmessage.c]
depends=../src/libApp.a

[appserver]
type=binary
sources=appserver.c
ldflags=../src/libApp.a

[appserver.c]
depends=../src/libApp.a,$(OBJDIR)Dummy.h

[includes]
type=binary
sources=includes.c

[lookup]
type=binary
sources=lookup.c

[lookup.c]
depends=../src/apptransport.h

[tests.log]
type=script
script=./tests.sh
depends=appclient,appmessage,appserver,includes,lookup,tests.sh,transport,../src/transport/tcp.c,../src/transport/udp.c

[transport]
type=binary
sources=transport.c

[transport.c]
depends=../src/libApp.a
